{% extends 'base_front.html.twig' %}

{% block title %}Nos Partenaires EzGo{% endblock %}

{% block body %}
<section class="partners-section">
    <h1>Nos Partenaires EzGo</h1>
    <p class="subtitle">Découvrez notre réseau de partenaires de confiance</p>

    <div class="partner-grid">
        {% for partenaire in partenaires %}
        <div class="partner-card">
            <div class="partner-header">
                <h2>{{ partenaire.nom }}</h2>
                
                {# Affichage des étoiles #}
                <div class="partner-rating">
                    {% set averageRating = partenaire.getAverageRating() %}
                    {% for i in 1..5 %}
                        <i class="fas fa-star {{ i <= averageRating ? 'text-warning' : 'text-muted' }}"></i>
                    {% endfor %}
                    <span>({{ partenaire.ratings|length }} avis)</span>
                </div>
            </div>

            <div class="partner-services">
                <ul>
                    {% for service in partenaire.getServices() %}
                        <li>{{ service }}</li>
                    {% endfor %}
                </ul>
            </div>

            <div class="partner-regions">
                <i class="fas fa-map-marker-alt"></i>
                {{ partenaire.getRegions()|join(', ') }}
            </div>

            <div class="partner-price">
                <strong>{{ partenaire.tarif }} DT/jour</strong>
                <a href="{{ path('app_location_new', {'idPartenaire': partenaire.idPartenaire}) }}" 
                   class="btn btn-reserver">
                   Réserver
                </a>
                
                {# Bouton de notation #}
                {% if is_granted('ROLE_USER') %}
                <a href="{{ path('app_partenaire_rate', {'idPartenaire': partenaire.idPartenaire}) }}" 
                   class="btn btn-noter">
                   <i class="fas fa-star"></i> Noter
                </a>
                {% endif %}
            </div>
        </div>
        {% endfor %}
    </div>
</section>
{% endblock %}